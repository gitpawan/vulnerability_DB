package com.opensource.vdb;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class DBConnection {

		public static Connection getConnection(){
			Connection con = null;
			try{
				Class.forName("com.mysql.jdbc.Driver");
				con = DriverManager.getConnection("jdbc:mysql://localhost:3306/issueData","root","");
				System.out.println("DB Connection successfull");
			}
		catch(ClassNotFoundException ce){
				ce.printStackTrace();
			}
			catch(SQLException se ){
				se.printStackTrace();
			}
			return con;
		}

		public static int insert(String query){
			Connection con = getConnection();
			int updatedRow = 0;
			try{
			PreparedStatement ps = con.prepareStatement(query);
			
			updatedRow = ps.executeUpdate();
			}
			catch(SQLException se){
				se.printStackTrace();
			}
			return updatedRow;
		}
		
		public static ResultSet retrieve(String query){
			Connection con = getConnection();
			ResultSet rs= null;
			try{
			Statement ps = con.createStatement();
			rs = ps.executeQuery(query);
			}
			catch(SQLException se){
				se.printStackTrace();
			}
			return rs;
		}
		
		
	}
		



